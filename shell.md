## Использование командной строки

Экранирование пробелов (два варианта):
```
mkdir ~/Program\ Files
mkdir ~/"Program Files (x86)"
```

Записать строку в файл (создать при отсутствии):
```
echo Hello, > hello.txt
echo World! >> hello.txt # append
```

Различные потоки вывода:
```
echo Smth 1> out.txt     # stdout
./error_prog 2> err.txt  # stderr
```

Поток ввода:
```
./count_words < in.txt 
```

Прерывание ввода и завершение:
```
Ctrl+D - принудительное закрытие входного потока
Ctrl+C - принудительное завершение программы (посылает сигнал)
Ctrl+Z - приостановка программы (SIGSTP), позже можно возобновить
```

## Команда `cat`
Выводит содержимое одного или нескольких файлов в стандартный поток вывода.

**Пример:**

```
cat file1.txt file2.txt  # на экран будет выведено содержимое сначала
                         # file1.txt, затем file2.txt
```

Эта команда часто используется для слияния нескольких файлов в один (в том
числе не только текстовых, но и бинарных):

```
cat header.txt body.txt footer.txt > document.txt
```

Если вызвать команду `cat` без аргументов, то в качестве входа испоьзуется
*стандартный поток ввода*. Таким способом можно создавать текстовые файлы,
не используя текстовый редактор:

```
cat > new_file.txt  # Будет осуществляться ввод с клавиатуры до нажатия Ctrl+D
```


## Команды `more` и `less` и перенаправление потока
Не все терминалы имеют возможность прокрутки содержимого, поэтому вывод командой
`cat` (или любой другой командой) содержимого большого текстового файла не
влезет на один экран.

Для того, чтобы организовать возможность прокрутки, предусмотрены команды
`more`, или `less`, которые принимают на вход текст из стандартного потока
ввода, и выводят его на экран постранично.

Команда `more` имеет возможность только прокрутки вперед с помощью клавиши
`ПРОБЕЛ`, команда `less` позволяет прокручивать текст как вперед, так и назад.

```
cat lorem_ipsum.txt | less
```

В данном примере программа `cat` выводит содержимое файла `lorem_ipsum.txt`
в стандартный поток вывода, а программа `less` отображает данные на экране из
стандартного потока ввода.

Оператор `|` между командами соединяет стандартный поток
вывода первой команды (`cat lorem_ipsum.txt`) со стандартным потоком
ввода второй команды (`less`), образуя *канал* передачи данных.

### `grep`
Выполняет фильрацию строк входного потока по *регулярному выражению* или
входжению некоторого текста и выводит результат в поток вывода.

Шаблон поиска является аргументом (заключается в кавычки, если содержит
пробельные символы или начинается с символа `-`). Часто используемые опции:
 * `-F` - выполнять поиск простого текста, а не регулярного выражения
 * `-v` - инвертировать условие поиска на противоположное
 * `-q` - ничего не выводить на экран (если требуется только код возврата)

Если найдена хотя бы одна строка, то код вовзрата равен `0`, иначе `1`.
Код возврата, отличный от `0` и `1` означает ошибку.

**Пример использования:**

**Файл some_text.txt:**

```
Hello, World!
# Hello
# This is a comment
This is not a comment
```

**Вывести все строки, содержащие слово 'Hello':**

```
cat some_text.txt | grep -F Hello
```

**Вывести все строки, содержащие фразу 'a comment':**

```
cat some_text.txt | grep -F "a comment"
```

**Вывести все строки, начинающиеся с символа решетки:**

```
cat some_text.txt | grep ^#
  # символ ^ в регулярном выражении обозначает начало строки
```

**Вывести все строки, НЕ начинающиеся с символа решетки:**

```
cat some_text.txt | grep -v ^#
```

**Определить, есть ли в тексте строка, начинающаяся с символа решетки:**

```
cat some_text.txt | grep -q ^#
echo $?  # результат 0, если найдена хотя бы одна строка
```

## Основные команды, о которых нужно помнить всегда

 * `man` - **самая нужная команда**; отображает справку по какой-либо команде
 * `cd` - перейти в другой каталог
 * `ls` - вывести содержимое каталога
 * `mkdir` - создать каталог
 * `cp` - скопировать файл или каталог
 * `mv` - переименовать файл или каталог
 * `rm` - удалить файл или каталог.

Для большинства команд предусмотрен аргумент `--help`, который отображает
короткую инструкцию по использованию команды.

### Команда `man`

`man РАЗДЕЛ ИМЯКОМАНДЫ` выводит справочную информацию по стандартным командам
UNIX, системным вызовам или функциям стандартной библиотеки Си.

Документация разбита на несколько разделов:
 * `1` - команды оболочки
 * `1p` - команды оболочки; выводится документация только на ту
 функциональность, которая соответствует стандарту POSIX
 * `2` - системные вызовы ядра операционной системы
 * `3` - функции стандартной библиотеки Си
 * `3p` - Си-функции POSIX API
 * `4` - описания модулей ядра и системных устройств
 * `5` - описания форматов конфигурационных файлов
 * `6` - описания программ для X11
 * `7` - различные руководства, не попадающие под какую-либо классификацию
 * `8` - руководства по администрированию
 * `n` - руководства Tcl.

Указывать раздел не обязательно. В этом случае будет отображен первый
найденный результат (как правило, руководство по команде). Некоторые
дистрибутивы, например openSUSE, сконфигурированы таким образом, что
команда `man` явно спрашивает номер раздела, если по запросу есть
несколько документов.

**Примеры использования**:

```
man 1p read  # отобразить справку по команде read
man 2 read   # отобразить справку по системному вызову read
man readline # отобразить справку по readline из <stdio.h>
man sudo     # отобразить справку по команде sudo
```

В последних двух случаях нужная страница присутствует только в одном
разделе справки, поэтому номер раздела не указан.


### Команда `ls`

Выводит в *стандартный поток вывода* (обычно это экран или окно терминала)
содержимое указанного каталога. Если каталог не указан в качестве аргумента,
то выводит содержимое текущего каталога.

```
ls ОПЦИИ КАТАЛОГ
```

Опции:
 * `-A` - отображать *скрытые файлы*, то есть те файлы, имена которых
 начинаются с точки
 * `-R` - рекурсивно пройти по всем подкаталогам и вывести их содержимое.


### Команда `mkdir`

Создает новый каталог. Опция `-p` указывает, что нужно создавать все
подкаталоги, которые не существуют в пути.

```
mkdir ~/new_dir  # новый каталог new_dir в домашнем каталоге
mkdir -p ~/new_dir/new_subdir1/new_subdir2  
                 # новый подкаталог new_subdir2 внутри
                 # ~/new_dir/new_subdir1, которые также создаются
```

### Команды `cp` и `mv`

Команда `cp` копирует файл, а команда `mv` перемещает (равнозначно
-- переименовывает) файл.

Первый аргумент - исходный файл или каталог; второй аргумент - новое имя.
Если копируется или перемещается обычный файл, а в качестве второго аргумента
указано имя каталога, то файл будет скопирован/перемещен в указанный каталог
с сохранением своего имени.

При указании опции `-R`, можно рекурсивно копировать каталоги.

### Команда `rm`

**Внимание!** Это деструктивная команда, используйте ее с осторожностью!

Команда `rm` удаляет файл или каталог. Для удаления каталога необходима
опция `-r`.


## Подстановка вывода команд

Вывод команд может быть направлен не только в файл, но и использован как
фрагмент другой команды. Для этого команда с необходимыми аргументами
заключается в *обратные одинарные кавычки* (этот символ находится на
PC-клавиатуре на одной клавише с буквой `Ё`).

**Пример.** Команда `date` выводит текущую дату и время. В качестве аргумента
ей можно передать формат вывода, например `date +%Y%m%d-%H%M` выведет дату
и время в формате `ГГГГММДД-ЧЧММ`. Допустим, нам требуется создать временный
каталог, в имени которого присутствует дата и время. Тогда можно использовать
вывод команды `date` для формирования аргумента команды `mkdir`:

```
mkdir temp-`date +%Y%m%d-%H%M`
```
